---
title: X.509 Certificate Based Authentication
markup: "mmark"
weight: 5
---

## X.509 Certificate Based Authentication

X.509 defines a framework which enables the validation of digital signatures. We can achieve mutual authentication using challenge-response authentication along with digital signatures and digital certificates.

-----

### X.509 Authentication using Public Keys
![X509 Public Keys](/docs/figures/x509-public-keys.png)

1. $$A$$ sends $$E_{KU_B}(r_A)$$ to $$B$$, where $$r_A$$ is a nonce generated by $$A$$.
1.  $$B$$ sends $$r_A$$ and $$E_{KU_A}(r_B)$$ to $$A$$, where $$r_B$$ is a nonce generated by $$B$$. As only $$B$$ can decrypt the first message, if $$B$$ is able to send $$r_A$$ back to $$A$$, this authenticates $$B$$ to $$A$$.
1. Likewise, $$A$$ will send $$r_B$$ back to $$B$$, which authenticates $$A$$ to $$B$$.

-----

### X.509 Authentication using Digital Signatures
![X509 Digital Signatures](/docs/figures/x509-digital-signature.png)

1. $$A$$ sends a nonce $$r_A$$ to $$B$$
1. $$B$$ sends a nonce $$r_B$$, $$B$$'s signature on $$A$$'s nonce, $$E_{KR_B}(H(R_A))$$ and $$Cert_B$$ to $$A$$. $$A$$ can then use certificate to obtain $$B$$'s public key to verify the signature sent by $$B$$.
1. Likewise, $$A$$ will send their signature on $$B$$'s nonce, $$E_{KR_A}(H(R_B))$$ and $$Cert_A$$ to $$B$$, where $$B$$ can carry out a similar verification.
