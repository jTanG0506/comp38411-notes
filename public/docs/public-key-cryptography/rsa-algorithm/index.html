<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="The RSA Algorithm"><meta property="og:title" content="The RSA Algorithm" />
<meta property="og:description" content="The RSA algorithm The RSA scheme is a block cipher in which the plaintext and ciphertext are represented as integers in the range \([0, n - 1]\) for some large \(n\), typically of 1024 bits (or 309 decimal digits). The RSA algorithm can be broken down into three steps: key generation, encryption, and decryption.
 Key Generation In RSA, the key pairs are generated as follows.
 Choose two large prime numbers, \(p\), \(q\) with \(p \neq q\) Calculate \(n = pq\) and \(\varphi(n) = (p - 1)(q - 1)\) Choose \(e \in \mathbb{Z}\), \(gcd(\phi(n), e) = 1\), \(e \in (1, \phi(n))\) Calculate \(d \equiv e^{-1} \; (\text{mod} \; \varphi(n))\)  The private key consists of \(\{d, n\}\) and the public key consists of \(\{e, n\}\)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://comp38411.jtang.dev/docs/public-key-cryptography/rsa-algorithm/" />

<title>The RSA Algorithm | COMP38411</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/book.min.881e5f617a25d889ee043796f91d24629f299fb09dafd02dfb7e5cda023ef8b8.css" integrity="sha256-iB5fYXol2InuBDeW&#43;R0kYp8pn7Cdr9At&#43;35c2gI&#43;&#43;Lg=">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css" integrity="sha384-BdGj8xC2eZkQaxoQ8nSLefg4AV4/AwB3Fj+8SUSo7pnKP6Eoy18liIKTPn9oBYNG" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.js" integrity="sha384-JiKN5O8x9Hhs/UE5cT5AAJqieYlOZbGT3CHws/y97o3ty4R7/O5poG9F3JoiOYw1" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136743321-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-136743321-4');
</script>



</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://comp38411.jtang.dev/"><span>COMP38411</span>
  </a>
</h2>






    <ul>
<li>
<p><strong>🦆 Big Duck NFT 🦆</strong></p>
<ul>
<li><a href="https://www.bigduck.io/">🦆 Website 🦆</a></li>
<li><a href="https://www.bigduck.io/twitter">🦆 Twitter 🦆</a></li>
<li><a href="https://www.bigduck.io/discord">🦆 Discord 🦆</a></li>
</ul>
</li>
<li>
<p><strong>Introduction</strong></p>
<ul>
<li><a href="/docs/introduction/revision/">Revision</a></li>
<li><a href="/docs/introduction/key-definitions/">Key Definitions</a></li>
<li><a href="/docs/introduction/security-attacks/">Security Attacks</a></li>
<li><a href="/docs/introduction/achieving-security/">Achieving Security</a></li>
<li><a href="/docs/introduction/attack-surfaces/">Attack Surfaces</a></li>
<li><a href="/docs/introduction/security-models/">Security Models</a></li>
</ul>
</li>
<li>
<p><strong>Introduction to Cryptography</strong></p>
<ul>
<li><a href="/docs/introduction-to-cryptography/symmetric-encryption/">Symmetric Encryption</a></li>
<li><a href="/docs/introduction-to-cryptography/one-time-pad/">One Time Pad</a></li>
<li><a href="/docs/introduction-to-cryptography/transpositions/">Transpositions</a></li>
<li><a href="/docs/introduction-to-cryptography/stream-ciphers/">Stream Ciphers</a></li>
<li><a href="/docs/introduction-to-cryptography/how-secure/">How Secure?</a></li>
<li><a href="/docs/introduction-to-cryptography/cryptanalysis/">Cryptanalysis</a></li>
</ul>
</li>
<li>
<p><strong>Conventional Cryptography</strong></p>
<ul>
<li><a href="/docs/conventional-cryptography/block-ciphers/">Block ciphers</a></li>
<li><a href="/docs/conventional-cryptography/fiestel-schemes/">Feistel schemes</a></li>
<li><a href="/docs/conventional-cryptography/data-encryption-standard/">Data Encryption Standard</a></li>
<li><a href="/docs/conventional-cryptography/advanced-encryption-standard/">Advanced Encryption Standard</a></li>
<li><a href="/docs/conventional-cryptography/modes-of-operation/">Modes of Operation</a></li>
<li><a href="/docs/conventional-cryptography/encrypting-any-message-in-cbc-mode/">Encrypting with CBC</a></li>
<li><a href="/docs/conventional-cryptography/attacks-on-block-ciphers/">Attacks on Block Ciphers</a></li>
</ul>
</li>
<li>
<p><strong>Public Key Cryptography</strong></p>
<ul>
<li><a href="/docs/public-key-cryptography/applications/">Applications of PKC</a></li>
<li><a href="/docs/public-key-cryptography/properties/">Properties of PKC</a></li>
<li><a href="/docs/public-key-cryptography/rsa-algorithm/"class=active>RSA Algorithm</a></li>
<li><a href="/docs/public-key-cryptography/malleability-of-textbook-rsa/">Malleability of Textbook RSA</a></li>
<li><a href="/docs/public-key-cryptography/rsa-for-encryption/">RSA for Encryption</a></li>
<li><a href="/docs/public-key-cryptography/breaking-textbook-rsa-signatures/">Breaking Textbook RSA Signatures</a></li>
<li><a href="/docs/public-key-cryptography/hybrid-cryptosystems/">Hybrid Cryptosystems</a></li>
</ul>
</li>
<li>
<p><strong>MAC and Hash Functions</strong></p>
<ul>
<li><a href="/docs/mac-and-hash-functions/digest-functions/">Digest Functions</a></li>
<li><a href="/docs/mac-and-hash-functions/message-authentication-code/">Message Authentication Code</a></li>
<li><a href="/docs/mac-and-hash-functions/keyed-hashes/">Keyed Hashes</a></li>
<li><a href="/docs/mac-and-hash-functions/hmac/">HMAC</a></li>
<li><a href="/docs/mac-and-hash-functions/authenticated-encryption/">Authenticated Encryption</a></li>
<li><a href="/docs/mac-and-hash-functions/authenticated-ciphers/">Authenticated Ciphers</a></li>
<li><a href="/docs/mac-and-hash-functions/counter-with-cbc/">Counter with CBC Mode</a></li>
<li><a href="/docs/mac-and-hash-functions/galois-counter-mode/">Galois Counter Mode</a></li>
</ul>
</li>
<li>
<p><strong>Digital Signatures</strong></p>
<ul>
<li><a href="/docs/digital-signatures/digital-signature-algorithm/">Digital Signature Algorithm</a></li>
<li><a href="/docs/digital-signatures/dsa-vs-rsa/">Comparison of DSA and RSA</a></li>
</ul>
</li>
<li>
<p><strong>Public Key Infrastructure</strong></p>
<ul>
<li><a href="/docs/public-key-infrastructure/overview-of-pki/">Overview of PKI</a></li>
<li><a href="/docs/public-key-infrastructure/digital-certificates/">Digital Certificates</a></li>
<li><a href="/docs/public-key-infrastructure/x509-certificates/">X.509 Certificates</a></li>
</ul>
</li>
<li>
<p><strong>Key Management</strong></p>
<ul>
<li><a href="/docs/key-management/key-management-issues/">Key Management Issues</a></li>
<li><a href="/docs/key-management/diffie-hellman-protocol/">Diffie-Hellman Protocol</a></li>
<li><a href="/docs/key-management/key-distribution-without-pkc/">Key Distribution without using PKC</a></li>
<li><a href="/docs/key-management/needham-schroeder-protocol/">Needham-Schroeder Protocol</a></li>
<li><a href="/docs/key-management/key-distribution-using-pkc/">Key Distribution using PKC</a></li>
<li><a href="/docs/key-management/comparison-of-key-establishment-protocols/">Comparison of Key Establishment Protocols</a></li>
</ul>
</li>
<li>
<p><strong>Entity Authentication</strong></p>
<ul>
<li><a href="/docs/entity-authentication/entity-authentication/">Entity Authentication</a></li>
<li><a href="/docs/entity-authentication/unix-password-based-authentication/">UNIX Password-Based Authentication</a></li>
<li><a href="/docs/entity-authentication/one-time-passwords/">One Time Passwords</a></li>
<li><a href="/docs/entity-authentication/smart-card-based-authentication/">Smart Card Based Authentication</a></li>
<li><a href="/docs/entity-authentication/x509-certificate-based-authentication/">X.509 Certificate Based Authentication</a></li>
</ul>
</li>
<li>
<p><strong>IP Security</strong></p>
<ul>
<li><a href="/docs/ip-security/tcp-ip-protocol-stack/">TCP / IP Protocol Stack</a></li>
<li><a href="/docs/ip-security/ip-sec/">IPSec</a></li>
<li><a href="/docs/ip-security/virtual-private-networks/">Virtual Private Networks</a></li>
<li><a href="/docs/ip-security/authentication-header/">Authentication Header</a></li>
<li><a href="/docs/ip-security/encapsulating-security-payload/">Encapsulating Security Payload</a></li>
<li><a href="/docs/ip-security/anti-replay/">Anti-Replay</a></li>
<li><a href="/docs/ip-security/combining-security-associations/">Combining Security Associations</a></li>
<li><a href="/docs/ip-security/comparison-of-ip-level-authentication/">Comparison of IP Level Authentication</a></li>
<li><a href="/docs/ip-security/comparison-of-transport-mode-and-tunnel-mode/">Comparison of Transport Mode and Tunnel Mode</a></li>
</ul>
</li>
</ul>





</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" alt="Menu" />
  </label>
  <strong>The RSA Algorithm</strong>
</header>

      
<article class="markdown">
  <h2 id="donation">🦆 Big Duck NFT</h2>
  <p><strong>10,000 uniquely generated, cute and social ducks with proof of ownership stored on the Polygon blockchain. Minting will be live on Mon 22 Nov, 12PM GMT. Check it out <a href="https://bigduck.io">here</a></strong>.</p>
  <hr><h2 id="the-rsa-algorithm">The RSA algorithm</h2>

<p>The RSA scheme is a block cipher in which the plaintext and ciphertext are represented as integers in the range <span  class="math">\([0, n - 1]\)</span> for some large <span  class="math">\(n\)</span>, typically of 1024 bits (or 309 decimal digits). The RSA algorithm can be broken down into three steps: key generation, encryption, and decryption.</p>

<hr>

<h3 id="key-generation">Key Generation</h3>

<p>In RSA, the key pairs are generated as follows.</p>

<ol>
<li><strong>Choose</strong> two large prime numbers, <span  class="math">\(p\)</span>, <span  class="math">\(q\)</span> with <span  class="math">\(p \neq q\)</span></li>
<li><strong>Calculate</strong> <span  class="math">\(n = pq\)</span> and <span  class="math">\(\varphi(n) = (p - 1)(q - 1)\)</span></li>
<li><strong>Choose</strong> <span  class="math">\(e \in \mathbb{Z}\)</span>, <span  class="math">\(gcd(\phi(n), e) = 1\)</span>, <span  class="math">\(e \in (1, \phi(n))\)</span></li>
<li><strong>Calculate</strong> <span  class="math">\(d \equiv e^{-1} \; (\text{mod} \; \varphi(n))\)</span></li>
</ol>

<p>The private key consists of <span  class="math">\(\{d, n\}\)</span> and the public key consists of <span  class="math">\(\{e, n\}\)</span>. We say that <span  class="math">\(d\)</span> and <span  class="math">\(e\)</span> are multiplicative inverses mod <span  class="math">\(\varphi(n)\)</span>, and we know that <span  class="math">\(ed \equiv 1 \; (\text{mod} \; \varphi(n))\)</span>. By our choice of <span  class="math">\(e\)</span> being coprime to <span  class="math">\(\varphi(n)\)</span>, we must also have that <span  class="math">\(d\)</span> is coprime to <span  class="math">\(\varphi(n)\)</span>.</p>

<p>Notice that finding <span  class="math">\(\varphi(n)\)</span> for an RSA modulus <span  class="math">\(n\)</span> is equivalent to breaking RSA, as the secret exponent <span  class="math">\(d\)</span> can be derived from <span  class="math">\(\varphi(n)\)</span> and <span  class="math">\(e\)</span>, by computing <span  class="math">\(e\)</span>'s inverse. Therefore <span  class="math">\(p\)</span> and <span  class="math">\(q\)</span> should also be kept secret, since knowing <span  class="math">\(p\)</span> or <span  class="math">\(q\)</span> allows us to compute <span  class="math">\(\varphi(n) = (p - 1)(q - 1)\)</span>.</p>

<hr>

<h3 id="encryption">Encryption</h3>

<p>To encrypt a plaintext, we represent it as an integer <span  class="math">\(M \in [0, n - 1]\)</span>, then encrypt as follows:</p>

<p><span  class="math">\[C = M^e \; \text{mod} \; n\]</span></p>

<hr>

<h3 id="decryption">Decryption</h3>

<p>Decryption is done as follows:</p>

<p><span  class="math">\[M = C^d \; \text{mod} \; n\]</span></p>

<hr>

<h3 id="example-of-rsa">Example of RSA</h3>

<p>We will do an example of the RSA algorithm, using small prime numbers, for convenience.</p>

<ul>
<li>Suppose we choose <span  class="math">\(p = 17\)</span> and <span  class="math">\(q = 11\)</span></li>
<li>We calculate <span  class="math">\(n = pq = 17 \times 11 = 187\)</span> and <span  class="math">\(\varphi(n) = (p - 1)(q - 1) = 16 \times 10 = 160\)</span></li>
<li>We choose <span  class="math">\(e = 7\)</span> and it is clear that <span  class="math">\(gcd(7, 160) = 1\)</span></li>
<li>We calculate <span  class="math">\(d\)</span> such that <span  class="math">\(de \equiv 1 \; \text{mod} \; n\)</span>, so <span  class="math">\(d = 23\)</span> as we have <span  class="math">\(23 \times 7 = 161 = (1 \times 160) + 1\)</span></li>
<li>Suppose we want to encrypt <span  class="math">\(M = 88\)</span>, then <span  class="math">\(C = 88^7 \; \text{mod} \; 187\)</span>. <span  class="math">\(88^7 \equiv 11 \; \text{mod} \; 187\)</span> so <span  class="math">\(C = 11\)</span></li>
<li>Now do decrypt <span  class="math">\(C = 11\)</span>, we need to compute <span  class="math">\(11^{23} \; \text{mod} \; 187\)</span>, which as <span  class="math">\(88\)</span>, as expected</li>
</ul>

<hr>

<h3 id="proof-of-rsa">Proof of RSA</h3>

<p>Euler's Theorem states that if <span  class="math">\(a\)</span> and <span  class="math">\(n\)</span> are coprime positive integers, then <span  class="math">\(a^{\varphi(n)} \equiv 1 \; (\text{mod} \: n)\)</span>.</p>

<p>Recall that in RSA, we have:</p>

<ol>
<li><span  class="math">\(n = pq\)</span>, where <span  class="math">\(p\)</span> and <span  class="math">\(q\)</span> are large primes</li>
<li><span  class="math">\(\varphi(n) = (p - 1)(q - 1)\)</span></li>
<li><span  class="math">\(e, d \in \mathbb{Z}\)</span> such that <span  class="math">\(e \equiv d^{-1} \; (\text{mod} \: n)\)</span> and so <span  class="math">\(ed = 1 + k\varphi(n)\)</span> for some <span  class="math">\(k \in \mathbb{Z}\)</span></li>
</ol>

<p>It follows that:</p>

<p><span  class="math">\[C^d \equiv (M^e)^d \equiv M^{1 + k\varphi(n)} \equiv M^1 \cdot (M^{\varphi(n)})^k \equiv M^1 \cdot 1^k \equiv M \; (\text{mod} \: n)\]</span></p>
</article>
<div id="container-ed2c23646475bf3cb681dcf1db6c94fb"></div>

      <div class="book-footer justify-between">
  

  

  
</div>

      
    </div>

    
  



  </main>

  
</body>

</html>
