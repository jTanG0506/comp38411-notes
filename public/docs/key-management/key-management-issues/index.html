<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Key Management Issues"><meta property="og:title" content="Key Management Issues" />
<meta property="og:description" content="Key Management Issues Key management refers to the management of keys in a cryptosystem, which includes:
 Generation: how should keys be generated such that the strength of the key is appropriate for the use case? Storage: how should keys be stored securely so that they cannot be easily stolen? Also, keys should never be stored alongside the data they are trying to protect, as any exfiltration of the protected data will also compromise the key." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://comp38411.jtang.dev/docs/key-management/key-management-issues/" />

<title>Key Management Issues | COMP38411</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/book.min.881e5f617a25d889ee043796f91d24629f299fb09dafd02dfb7e5cda023ef8b8.css" integrity="sha256-iB5fYXol2InuBDeW&#43;R0kYp8pn7Cdr9At&#43;35c2gI&#43;&#43;Lg=">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css" integrity="sha384-BdGj8xC2eZkQaxoQ8nSLefg4AV4/AwB3Fj+8SUSo7pnKP6Eoy18liIKTPn9oBYNG" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.js" integrity="sha384-JiKN5O8x9Hhs/UE5cT5AAJqieYlOZbGT3CHws/y97o3ty4R7/O5poG9F3JoiOYw1" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136743321-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-136743321-4');
</script>



</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://comp38411.jtang.dev/"><span>COMP38411</span>
  </a>
</h2>






    <ul>
<li>
<p><strong>Save The Koalas üê®</strong></p>
<ul>
<li><a href="https://www.redcross.org.au/campaigns/disaster-relief-and-recovery-donate">Donate to Australian Red Cross</a></li>
</ul>
</li>
<li>
<p><strong>Introduction</strong></p>
<ul>
<li><a href="/docs/introduction/revision/">Revision</a></li>
<li><a href="/docs/introduction/key-definitions/">Key Definitions</a></li>
<li><a href="/docs/introduction/security-attacks/">Security Attacks</a></li>
<li><a href="/docs/introduction/achieving-security/">Achieving Security</a></li>
<li><a href="/docs/introduction/attack-surfaces/">Attack Surfaces</a></li>
<li><a href="/docs/introduction/security-models/">Security Models</a></li>
</ul>
</li>
<li>
<p><strong>Introduction to Cryptography</strong></p>
<ul>
<li><a href="/docs/introduction-to-cryptography/symmetric-encryption/">Symmetric Encryption</a></li>
<li><a href="/docs/introduction-to-cryptography/one-time-pad/">One Time Pad</a></li>
<li><a href="/docs/introduction-to-cryptography/transpositions/">Transpositions</a></li>
<li><a href="/docs/introduction-to-cryptography/stream-ciphers/">Stream Ciphers</a></li>
<li><a href="/docs/introduction-to-cryptography/how-secure/">How Secure?</a></li>
<li><a href="/docs/introduction-to-cryptography/cryptanalysis/">Cryptanalysis</a></li>
</ul>
</li>
<li>
<p><strong>Conventional Cryptography</strong></p>
<ul>
<li><a href="/docs/conventional-cryptography/block-ciphers/">Block ciphers</a></li>
<li><a href="/docs/conventional-cryptography/fiestel-schemes/">Feistel schemes</a></li>
<li><a href="/docs/conventional-cryptography/data-encryption-standard/">Data Encryption Standard</a></li>
<li><a href="/docs/conventional-cryptography/advanced-encryption-standard/">Advanced Encryption Standard</a></li>
<li><a href="/docs/conventional-cryptography/modes-of-operation/">Modes of Operation</a></li>
<li><a href="/docs/conventional-cryptography/encrypting-any-message-in-cbc-mode/">Encrypting with CBC</a></li>
<li><a href="/docs/conventional-cryptography/attacks-on-block-ciphers/">Attacks on Block Ciphers</a></li>
</ul>
</li>
<li>
<p><strong>Public Key Cryptography</strong></p>
<ul>
<li><a href="/docs/public-key-cryptography/applications/">Applications of PKC</a></li>
<li><a href="/docs/public-key-cryptography/properties/">Properties of PKC</a></li>
<li><a href="/docs/public-key-cryptography/rsa-algorithm/">RSA Algorithm</a></li>
<li><a href="/docs/public-key-cryptography/malleability-of-textbook-rsa/">Malleability of Textbook RSA</a></li>
<li><a href="/docs/public-key-cryptography/rsa-for-encryption/">RSA for Encryption</a></li>
<li><a href="/docs/public-key-cryptography/breaking-textbook-rsa-signatures/">Breaking Textbook RSA Signatures</a></li>
<li><a href="/docs/public-key-cryptography/hybrid-cryptosystems/">Hybrid Cryptosystems</a></li>
</ul>
</li>
<li>
<p><strong>MAC and Hash Functions</strong></p>
<ul>
<li><a href="/docs/mac-and-hash-functions/digest-functions/">Digest Functions</a></li>
<li><a href="/docs/mac-and-hash-functions/message-authentication-code/">Message Authentication Code</a></li>
<li><a href="/docs/mac-and-hash-functions/keyed-hashes/">Keyed Hashes</a></li>
<li><a href="/docs/mac-and-hash-functions/hmac/">HMAC</a></li>
<li><a href="/docs/mac-and-hash-functions/authenticated-encryption/">Authenticated Encryption</a></li>
<li><a href="/docs/mac-and-hash-functions/authenticated-ciphers/">Authenticated Ciphers</a></li>
<li><a href="/docs/mac-and-hash-functions/counter-with-cbc/">Counter with CBC Mode</a></li>
<li><a href="/docs/mac-and-hash-functions/galois-counter-mode/">Galois Counter Mode</a></li>
</ul>
</li>
<li>
<p><strong>Digital Signatures</strong></p>
<ul>
<li><a href="/docs/digital-signatures/digital-signature-algorithm/">Digital Signature Algorithm</a></li>
<li><a href="/docs/digital-signatures/dsa-vs-rsa/">Comparison of DSA and RSA</a></li>
</ul>
</li>
<li>
<p><strong>Public Key Infrastructure</strong></p>
<ul>
<li><a href="/docs/public-key-infrastructure/overview-of-pki/">Overview of PKI</a></li>
<li><a href="/docs/public-key-infrastructure/digital-certificates/">Digital Certificates</a></li>
<li><a href="/docs/public-key-infrastructure/x509-certificates/">X.509 Certificates</a></li>
</ul>
</li>
<li>
<p><strong>Key Management</strong></p>
<ul>
<li><a href="/docs/key-management/key-management-issues/"class=active>Key Management Issues</a></li>
<li><a href="/docs/key-management/diffie-hellman-protocol/">Diffie-Hellman Protocol</a></li>
<li><a href="/docs/key-management/key-distribution-without-pkc/">Key Distribution without using PKC</a></li>
<li><a href="/docs/key-management/needham-schroeder-protocol/">Needham-Schroeder Protocol</a></li>
<li><a href="/docs/key-management/key-distribution-using-pkc/">Key Distribution using PKC</a></li>
<li><a href="/docs/key-management/comparison-of-key-establishment-protocols/">Comparison of Key Establishment Protocols</a></li>
</ul>
</li>
<li>
<p><strong>Entity Authentication</strong></p>
<ul>
<li><a href="/docs/entity-authentication/entity-authentication/">Entity Authentication</a></li>
<li><a href="/docs/entity-authentication/unix-password-based-authentication/">UNIX Password-Based Authentication</a></li>
<li><a href="/docs/entity-authentication/one-time-passwords/">One Time Passwords</a></li>
<li><a href="/docs/entity-authentication/smart-card-based-authentication/">Smart Card Based Authentication</a></li>
<li><a href="/docs/entity-authentication/x509-certificate-based-authentication/">X.509 Certificate Based Authentication</a></li>
</ul>
</li>
<li>
<p><strong>IP Security</strong></p>
<ul>
<li><a href="/docs/ip-security/tcp-ip-protocol-stack/">TCP / IP Protocol Stack</a></li>
<li><a href="/docs/ip-security/ip-sec/">IPSec</a></li>
<li><a href="/docs/ip-security/virtual-private-networks/">Virtual Private Networks</a></li>
<li><a href="/docs/ip-security/authentication-header/">Authentication Header</a></li>
<li><a href="/docs/ip-security/encapsulating-security-payload/">Encapsulating Security Payload</a></li>
<li><a href="/docs/ip-security/anti-replay/">Anti-Replay</a></li>
<li><a href="/docs/ip-security/combining-security-associations/">Combining Security Associations</a></li>
<li><a href="/docs/ip-security/comparison-of-ip-level-authentication/">Comparison of IP Level Authentication</a></li>
<li><a href="/docs/ip-security/comparison-of-transport-mode-and-tunnel-mode/">Comparison of Transport Mode and Tunnel Mode</a></li>
</ul>
</li>
</ul>





</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/svg/menu.svg" alt="Menu" />
  </label>
  <strong>Key Management Issues</strong>
</header>

      
<article class="markdown">
  <h2 id="donation">üê® Save The Koalas</h2>
  <p>The Australian Red Cross are supporting thousands of people affected by the bushfires and with your support, they can help and support these communities to recover during their time of need. <strong>If you found these notes useful, please consider donating to The Australian Red Cross <a href="https://www.redcross.org.au/campaigns/disaster-relief-and-recovery-donate">here</a></strong>.</p>
  <hr><h2 id="key-management-issues">Key Management Issues</h2>

<p>Key management refers to the management of keys in a cryptosystem, which includes:</p>

<ol>
<li><strong>Generation</strong>: how should keys be generated such that the strength of the key is appropriate for the use case?</li>
<li><strong>Storage</strong>: how should keys be stored securely so that they cannot be easily stolen? Also, keys should never be stored alongside the data they are trying to protect, as any exfiltration of the protected data will also compromise the key.</li>
<li><strong>Transportation</strong>: how should keys be delivered to their intended recipients securely? Physical exchange of keys is impractical while     sending the key through an existing encryption channel relies on the security of a previous key exchange.</li>
<li><strong>Establishment</strong>: how can two communicating parties agree on a key to be used?</li>
<li><strong>Revocation</strong>: how are keys revoked and replaced, should that key happen to be compromised, or we wish the withdraw the holders' privilege of that key?</li>
</ol>

<hr>

<h3 id="key-spaces">Key Spaces</h3>

<p>The <strong>key space</strong> is the set of all possible permutations of a key. For example, if your key consists of 3 letters, and each of these letters must be from the set <span  class="math">\(\{A, B\}\)</span>, then the key space would be <span  class="math">\(\{AAA, AAB, ABA, ABB, BBB, BBA, BAB, BAA\}\)</span> with size <span  class="math">\(8 = 2^3\)</span>. Notice that we have to choose <span  class="math">\(3\)</span> letters, and for each letter, we have <span  class="math">\(2\)</span> choices; thus, the total number of combinations is <span  class="math">\(2^3\)</span>.</p>

<table>
<thead>
<tr>
<th>Key Space</th>
<th align="center">Size</th>
<th align="center">Number of possible keys (6-bytes)</th>
<th align="center">Number of possible keys (8-bytes)</th>
<th align="center">Exhaustive search* (6-bytes)</th>
<th align="center">Exhaustive search* (8-bytes)</th>
</tr>
</thead>

<tbody>
<tr>
<td>Lowercase letters</td>
<td align="center"><span  class="math">\(26\)</span></td>
<td align="center"><span  class="math">\(3.1 \times 10^8\)</span></td>
<td align="center"><span  class="math">\(2.1 \times 10^{11}\)</span></td>
<td align="center">5 minutes</td>
<td align="center">2.4 days</td>
</tr>

<tr>
<td>Lowercase letters and digits</td>
<td align="center"><span  class="math">\(36\)</span></td>
<td align="center"><span  class="math">\(2.2 \times 10^9\)</span></td>
<td align="center"><span  class="math">\(2.8 \times 10^{12}\)</span></td>
<td align="center">36 minutes</td>
<td align="center">33 days</td>
</tr>

<tr>
<td>Alphanumeric characters</td>
<td align="center"><span  class="math">\(62\)</span></td>
<td align="center"><span  class="math">\(5.7 \times 10^{10}\)</span></td>
<td align="center"><span  class="math">\(2.2 \times 10^{14}\)</span></td>
<td align="center">16 hours</td>
<td align="center">6.9 years</td>
</tr>

<tr>
<td>Printable characters</td>
<td align="center"><span  class="math">\(95\)</span></td>
<td align="center"><span  class="math">\(7.4 \times 10^{11}\)</span></td>
<td align="center"><span  class="math">\(6.6 \times 10^{15}\)</span></td>
<td align="center">8.5 days</td>
<td align="center">210 years</td>
</tr>

<tr>
<td>ASCII characters</td>
<td align="center"><span  class="math">\(128\)</span></td>
<td align="center"><span  class="math">\(4.4 \times 10^{12}\)</span></td>
<td align="center"><span  class="math">\(7.2 \times 10^{16}\)</span></td>
<td align="center">51 days</td>
<td align="center">2300 years</td>
</tr>
</tbody>
</table>

<p>* = at <span  class="math">\(10^6\)</span> attempts/sec</p>

<p>To prevent an adversary from performing an exhaustive search for the key, the key space should be chosen to be large enough to make such a search infeasible. Besides, placing constraints on the alphabet will significantly reduce the number of possible keys, thus making ciphertexts much easier to break. Since computing power approximately doubles every 18 months, we should plan accordingly if we expect a key to withstand brute force attacks and have a lifetime of 10 years, for example.</p>

<hr>

<h3 id="key-generation">Key Generation</h3>

<p>A desirable property for keys is that they must be selected in a truly random fashion. Should this not be the case, and the attacker can determine some factor which may influence the selection of the key, the search space can be significantly reduced. For example, humans generally do not choose passwords randomly; therefore, attackers can try the more obvious ones first instead of a systematic brute force search.</p>

<p>A good key is a random number. Ordinary random number generators such as <code>java.util.Random</code> may not be a good enough for this purpose; however, we have cryptographically secure pseudo-random number generators, such as the <code>SecureRandom</code> class in the <code>java.security</code> package.</p>

<h4 id="random-numbers">Random numbers</h4>

<p>Given <span  class="math">\(k \in \mathbb{Z}\)</span> and a sequence of numbers <span  class="math">\(n_1, n_2, \dots\)</span>, if an observer cannot predict <span  class="math">\(n_k\)</span>, even if all of <span  class="math">\(n_1, \dots, n_{k-1}\)</span> are known, then we say <span  class="math">\(n_k\)</span> is a random number. Random numbers can be obtained from a source of uncertainty, or <em>source of entropy</em>, such as atmospheric noise, stock market data and polarization of photons.</p>

<h4 id="strong-mixing-functions">Strong mixing functions</h4>

<p>We can generate pseudo-random numbers from a <strong>strong mixing function</strong>, which is, a function that takes two or more inputs having some <em>randomness</em> (such as CPU load and arrival times of network packets) and produces an output where each bit depends on some non-linear function of all the bits of the inputs. Cryptographic hashing functions and encryption algorithms, such as MD5, SHA, and DES, are all examples of strong mixing functions.</p>

<p>For example, in a UNIX system, you may use the process state at a given time (<code>date; ps gaux</code>) as the input to an MD5 function to generate a pseudorandom number, where <code>ps gaux</code> lists all the information about all the processes on the system.</p>

<hr>

<h3 id="key-storage">Key Storage</h3>

<p>Once we have a secret key, you need to keep it secret, to the same degree as all the data it encrypts. Otherwise, an attacker would not need to go through all the trouble of trying to break the cipher system if the key can be recovered due to inadequate key storage procedures. For example, an attacker could bribe a clerk for <span  class="math">\(\pounds 1000\)</span> instead of spending <span  class="math">\(\pounds 10m\)</span> on building a cryptanalysis machine.</p>

<h4 id="key-wrapping">Key wrapping</h4>

<p>Attackers may be able to defeat access control mechanisms, so we should encrypt the key using a second key. Ideally, a key should never appear unencrypted outside the encryption device and not be stored on a medium connected to the network. The problem with this approach is that the second key must be available when you need to decrypt the protected key. Usually, the second key is often generated from a password supplied by the user when they need to use the protected key - this is how private keys for SSH are usually protected.</p>

<h4 id="hardware-tokens">Hardware tokens</h4>

<p>If the key resides in memory, attackers may be able to read the key if they can get access to the machine. In this approach, the key is stored on a physical token, such as a smart card or a USB dongle, and remains safe even if the machine is compromised, as they usually require you to enter a PIN to unlock the key from the secure memory.</p>

<p>This approach is costly and also less convenient as it requires you to carry the hardware token with you and run the risk of losing it or it being stolen. As the hardware token can be stolen, we should split the key into two halves, and store one half in the card and the other half in the machine.</p>

<hr>

<h3 id="session-key-establishment">Session Key Establishment</h3>

<p>A session key is a temporary key which is used for the duration of a logical connection. Ideally, the session key should have a very short lifetime, and a new session key should be used for each new session.</p>

<p>It is desirable to exchange session keys frequently, as this means the opponent has less ciphertext available for cryptanalysis for any given session key, thus making the key more secure. Also, the shorter lifetime of a session key limits the exposure, in terms of both time and amount of data, in the event of key compromise. We can avoid long-term storage of a large number of secret keys, by only creating them for each exchange.</p>

<p>However, the distribution of session keys will delay the start of any exchange and places a burden on network capacity. Therefore, we must try to balance these considerations when determining a suitable lifetime for a particular session key.</p>
</article>
<div id="container-ed2c23646475bf3cb681dcf1db6c94fb"></div>

      <div class="book-footer justify-between">
  

  

  
</div>

      
    </div>

    
  



  </main>

  
</body>

</html>
